@model HomeViewModel
@using SFA.Apprenticeships.Web.Raa.Common.ViewModels.ProviderUser
@using SFA.Apprenticeships.Web.Recruit.Constants
@{
    ViewBag.Title = "Recruit an Apprentice";
}

@using (Html.BeginForm(null, "ProviderUser", null, FormMethod.Post))
{
    @Html.AntiForgeryToken()
    @Html.Partial("ValidationSummary", ViewData.ModelState)

    <div class="grid-wrapper">
        <div class="grid-1-2 grid">
            <h1 class="heading-xlarge">
                Recruitment home
                <span class="heading-secondary">@Model.ProviderViewModel.ProviderName</span>
            </h1>
        </div>
        <div class="grid grid-1-2">
            <div class="">
                @if (Model.ProviderSites.Count == 1)
                {
                    <p class="form-label">Provider site</p>
                    Model.ProviderUserViewModel.DefaultProviderSiteErn = Model.ProviderSites[0].Value;
                    @Html.HiddenFor(m => m.ProviderUserViewModel.DefaultProviderSiteErn)
                    <p>@Model.ProviderSites[0].Text</p>
                }
                else
                {
                    <p class="form-label">Change provider site</p>
                    @Html.DropDownListFor(m => m.ProviderUserViewModel.DefaultProviderSiteErn, Model.ProviderSites, new {@class = "chosen-select"})
                    <button id="change-training-site-button" type="submit" name="ProviderSiteAction" class="button" value="ChangeProviderSite">Change</button>
                }
            </div>
        </div>
    </div>

    <section>
        <button id="new-vacancy-button" type="submit" name="ProviderSiteAction" class="button" value="NewVacancy">Create new vacancy</button>
    </section>

    <section class="grid-wrapper">
        @{
            var filterType = Model.VacanciesSummary.VacanciesSummarySearch.FilterType;
        }
        <h2 class="heading-medium">Your vacancies
            @if (filterType != VacanciesSummaryFilterTypes.All)
            {
                <a href="@Url.RouteUrl(RecruitmentRouteNames.RecruitmentHome, new {FilterType = VacanciesSummaryFilterTypes.All})" class="font-small">Show all</a>
            }
        </h2>
        <div class="grid" style="width: 16.6%">
            <p style="text-align: center">
                @if (filterType == VacanciesSummaryFilterTypes.Live)
                {
                    <span>Live</span>
                }
                else
                {
                    <a href="@Url.RouteUrl(RecruitmentRouteNames.RecruitmentHome, new {FilterType = VacanciesSummaryFilterTypes.Live})">Live</a>
                }
            </p>
            <p style="text-align: center; font-size: 96px; font-weight: 700;">@Model.VacanciesSummary.LiveCount</p>
        </div>
        <div class="grid" style="width: 16.6%">
            <p style="text-align: center">
                @if (filterType == VacanciesSummaryFilterTypes.Approved)
                {
                    <span>Approved</span>
                }
                else
                {
                    <a href="@Url.RouteUrl(RecruitmentRouteNames.RecruitmentHome, new {FilterType = VacanciesSummaryFilterTypes.Approved})">Approved</a>
                }
            </p>
            <p style="text-align: center; font-size: 96px; font-weight: 700;">@Model.VacanciesSummary.ApprovedCount</p>
        </div>
        <div class="grid" style="width: 16.6%">
            <p style="text-align: center">
                @if (filterType == VacanciesSummaryFilterTypes.Rejected)
                {
                    <span>Rejected</span>
                }
                else
                {
                    <a href="@Url.RouteUrl(RecruitmentRouteNames.RecruitmentHome, new {FilterType = VacanciesSummaryFilterTypes.Rejected})">Rejected</a>
                }
            </p>
            <p style="text-align: center; font-size: 96px; font-weight: 700;">@Model.VacanciesSummary.RejectedCount</p>
        </div>
        <div class="grid" style="width: 16.6%">
            <p style="text-align: center">
                @if (filterType == VacanciesSummaryFilterTypes.ClosingSoon)
                {
                    <span>Closing Soon</span>
                }
                else
                {
                    <a href="@Url.RouteUrl(RecruitmentRouteNames.RecruitmentHome, new {FilterType = VacanciesSummaryFilterTypes.ClosingSoon})">Closing Soon</a>
                }
            </p>
            <p style="text-align: center; font-size: 96px; font-weight: 700;">@Model.VacanciesSummary.ClosingSoonCount</p>
        </div>
        <div class="grid" style="width: 16.6%">
            <p style="text-align: center">
                @if (filterType == VacanciesSummaryFilterTypes.Closed)
                {
                    <span>Closed</span>
                }
                else
                {
                    <a href="@Url.RouteUrl(RecruitmentRouteNames.RecruitmentHome, new {FilterType = VacanciesSummaryFilterTypes.Closed})">Closed</a>
                }
            </p>
            <p style="text-align: center; font-size: 96px; font-weight: 700;">@Model.VacanciesSummary.ClosedCount</p>
        </div>
        <div class="grid" style="width: 16.6%">
            <p style="text-align: center">
                @if (filterType == VacanciesSummaryFilterTypes.Draft)
                {
                    <span>Draft</span>
                }
                else
                {
                    <a href="@Url.RouteUrl(RecruitmentRouteNames.RecruitmentHome, new {FilterType = VacanciesSummaryFilterTypes.Draft})">Draft</a>
                }
            </p>
            <p style="text-align: center; font-size: 96px; font-weight: 700;">@Model.VacanciesSummary.DraftCount</p>
        </div>
    </section>

    <div class="grid-wrapper">
        <div class="grid grid-1-1">
                <section>
                    <div class="grid-wrapper font-xsmall med-btm-margin">
                        @*<div class="grid grid-2-3">
                            <div class="inner-block-padr">
                                <select name="" id="" class="form-label">
                                    <option value="" hidden>-- Filter vacancies --</option>
                                    <option value="">Employer</option>
                                    <option value="">Title</option>
                                    <option value="">Framework</option>
                                </select>
                                <input type="text" class="form-control width-all-1-1" id="filter-employers">
                            </div>
                        </div>
                        <div class="grid grid-1-3 ta-right">
                            <input type="text" class="form-control invisible med-btm-margin">
                            <select name="" id="" class="small-right-margin">
                                <option value="" hidden>-- Filter status --</option>
                                <option value="">All</option>
                                <option value="">Live</option>
                                <option value="">For review</option>
                                <option value="">Submitted</option>
                                <option value="">Drafts</option>
                                <option value="">Closed</option>
                            </select>
                        </div>*@
                    </div>
                    <div class="tabbed-element tab1 active width-all-1-1">
                        <table class="no-btm-margin">
                            <colgroup>
                                <col class="t25">
                                <col class="t20">
                                <col class="t20">
                                <col class="t20">
                                <col class="t15">
                            </colgroup>
                            <thead>
                            <tr>
                                <th>Vacancy title</th>
                                <th>Employer</th>
                                <th>Vacancy ref</th>
                                <th>Number of applications</th>
                                <th>Vacancy status</th>
                            </tr>
                            </thead>
                            <tbody>
                            @foreach(var vacancy in Model.VacanciesSummary.Vacancies.Page)
                            {
                                <tr>
                                    <td>
                                        <div class="vac-title">
                                            @{
                                                var title = string.IsNullOrEmpty(vacancy.NewVacancyViewModel.Title) ? "(No Title)" : vacancy.NewVacancyViewModel.Title;
                                            }
                                            <a href="@Url.RouteUrl(RecruitmentRouteNames.EditVacancy, new {vacancyReferenceNumber = vacancy.VacancyReferenceNumber})" class="disp-block link-unimp">@title@*<span class="inl-block">(? applications)</span>*@</a>
                                        </div>
                                    </td>
                                    <td>
                                        @vacancy.NewVacancyViewModel.ProviderSiteEmployerLink.Employer.Name
                                    </td>
                                    <td>
                                        @vacancy.VacancyReferenceNumber
                                    </td>
                                    <td>
                                        X applications
                                    </td>
                                    <td>
                                        @{ Html.RenderPartial("_vacancyStatus", @vacancy.Status); }
                                        @{ Html.RenderPartial("_closingDate", @vacancy.VacancySummaryViewModel.ClosingDate); }
                                    </td>
                                </tr>
                            }
                            </tbody>
                        </table>
                        @*<div class="page-navigation font-xsmall small-btm-margin">
                            <a href="#" class="page-navigation__btn previous disabled">
                                <i class="arrow-button fa fa-angle-left"></i>
                                <span class="description">Previous</span>
                                <span class="counter">1 of 2</span>
                            </a>
                            <a href="#" class="page-navigation__btn next">
                                <i class="arrow-button fa fa-angle-right"></i>
                                <span class="description">Next</span>
                                <span class="counter">2 of 2</span>
                            </a>
                        </div>*@
                    </div>
                </section>
        </div>
    </div>
}
